# Поиск двух точек, расстояние между которыми минимально

## Алгоритм через разделяйку

Давайте воспользуемся идеей разделяй и властвуй, а именно отсортируем наши точки по $x$ координатам и будем вычислять ответ следующим образом:

- Разделим наш массив на 2 части, после чего посчитаем ответ отдельно в каждой, пусть это будет $D_1, D_2$ соответственно.
- Теперь осталось обработать случай, когда нужная нам пара лежит не в одной части, теперь заметим, что можно нужное нам расстояние точно меньше $D = min(D_1, D_2)$, а значит рассмотрим от прямой которой мы делили наши точки по $x$ вертикальную полоску на расстоянии $D$ от нее. Тогда если эти точки отсортированы по $y$, то кандидатов не больше 7, а значит обьединять ответ мы умеем за $O(n)$, если точки в полоске отсортированны по $y$. (Как это поддерживать остается читателю).

![image](/src_of_algo/images/image_for_closest_dots.png)

Время работы: $T(n) = 2T(\dfrac{n}{2}) + O(n)$.

Тогда по Мастер-Теорме получим время итоговое время работы $O(n \log n)$.

[Реализация](/src_of_algo/geometry/closest_pair_of_points/divide_and_conquer.cpp)

## Алгоритм через рандом

Давайте рассмотрим следующий алгоритм:

Будем рассматривать точки по порядку, поддерживая текущее минимальное расстояние $d$. Давайте поддерживать следующую стуктуру: будем хранить сетку $d \times d$, где для каждого блока будем знать какие точки в нем находятся.

![image](/src_of_algo/images/image_for_random_algo_for_closest_dots.png)

Заметим, что в каждом блоке точно не больше 4 точек. Пусть мы хотим добавить очередную $k$-ую точку в нашу структуру, тогда если минимальное расстояние уменьшилось (проверка этого делается за $O(1)$ ), тогда нужно перестроить всю структуру(это делается за $O(k)$ ).

На данный момент лишь можно сказать, что алгоритм работает за $O(n^2)$ . но давайте теперь давайте сделаем следующий трюк: случайно переставим точки(сделаем шафл). И попробуем оценить матожидание времени работы. Вероятность того, что $k$-ая точка станет одной из точек, которая будет ответ равен $\frac{2}{k}$ .

Тогда:

$$
T(n) = \displaystyle\sum_{k = 1}^{n} \frac{2}{k} \cdot k = \sum_{k = 1}^{n} 2 = 2n = O(n)
$$

[Реализация](/src_of_algo/geometry/closest_pair_of_points/random.cpp)