# Алгоритмы и структуры данных. Домашнее задание №1

## Выполнил студент Наседкин Дмитрий Сергеевич (группа 242)

## Письменная часть

### № 1

Псевдокод:

```cpp
func genRandomTriple(n, a, b, c) {
    t1 = genRandomInteger(1, n)
    t2 = genRandomInteger(1, n - 1)
    t3 = genRandomInteger(1, n - 2)

    if (t2 >= t1) {
        t2 += 1
    }

    if (t3 >= t1) {
        t3 += 1
    }
    if (t3 >= t2) {
        t3 += 1
    }

    a = min(t1, t2, t3)
    c = max(t1, t2, t3)
    b = t1 + t2 + t3 - a - b
}
```

Очевидно, что алгоритм работает за $ O(1) $ (Не матожидание)

Теперь докажем, что алгоритм генерирует каждую тройку равновероятно:

- Для начала скажем, что $a, b, c$ полученные после выполнения алгоритма будут различны и $ 1 \leq a < b < c \leq n$

- Очевидно, что всего существует $ \dbinom{n}{3} $ таких троек(не от алгоритма), то есть раскрыв бином получим $ \dfrac{n(n - 1)(n - 2)}{6} $

- То есть нам нужно доказать, троек от алгоритма возможно столько же, и правда мы генирируем $ n(n - 1)(n - 2) $ различных троек, при этом после сортировки их число сокращается до: $$ \frac{n(n - 1)(n - 2)}{3!} = \frac{n(n - 1)(n - 2)}{6} $$

ч. т. д.

### № 2

Из школы знаем, что cnt_divisors(n) = $ \displaystyle\prod_{i = 1}^{m} (\alpha_i + 1) $

Для начала заметим, что если $x_i$ не отсортированные, то непонятно как считать матожидание, так как появляются зависимости.

Поэтому будем считать, что $xi$(вместе с $pi$) отсортированы, тогда они разбиваются на непересекающиеся отрезки, внутри которых равные $x$.

Также заметим, так как отрезки непересекаются, то матожидание коэфицентов $a$ при $x$ станут независимыми, поэтому теперь $$ E(\xi) = \displaystyle\prod_{i = 1}^{m} (E(\xi_i) + 1), $$ где:

- $ m $ - кол-во отрезков
- $E(\xi_i)$ - мат. ожидание коэфицента $\alpha$ при $x$ для текущего отрезка

Введем следующую индикаторную величину:
$$
I_k =
    \begin{cases}
    1,     \;\;\;  \text{если число выбрано}\\
    0,     \;\;\;  \text{иначе}
    \end{cases}
$$

Тогда матожидание значения коэфицента для отрезка $(l, r)$:
$$
E(\xi_i) = \displaystyle\sum_{l}^{r}
E(I_l) = \displaystyle\sum_{l}^{r} p_l
$$

#### Алгоритм

1) Отсортируем $x_i$ вместе с $p_i$
2) Будем двигаться двумя указателями поддерживая текущий отрезок на котором равные числа, и как дошли до конца посчитаем $E(\xi_i) + 1$
3) Перемножим все посчитанные матожидания и получим искомое $E(\xi)$

Время работы алгоритма -
$$
 O(\text{время сортировки}) + O(\text{проход двумя указателями}) = O(n\log{n}) + O(n) = O(n\log{n})
$$

### № 3

Назовем цикл длины три **треугольником**.

Для начала скажем, что пусть у нас есть произовльный разрез $A \subset V$, тогда очевидно, что треугольники лежащие в $A$, $V/A$, так и вне разреза никак не влияют друг на друга(другими словами **независимы**).

Теперь рассмотрим произвольный треугольник $(v, u, w)$, тогда существует всего 2 варианта когда он полностью войдет в компоненту: 
$$
(v, u, w) \in A \; \vee (v, u, w) \in V/A
$$

Введем следующую индикаторную величину:
$$
I_i =
    \begin{cases}
    1,     \;\;\;  i\text{-й треугольник в одной компоненте} \\
    0,     \;\;\;  \text{иначе}
    \end{cases}
$$

Тогда матожидание кол-ва треугольников:

$$
E(\xi) = \displaystyle\sum_{i = 1}^{k}
E(I_i) = \displaystyle\sum_{i = 1}^{k} p_i =
\displaystyle\sum_{i = 1}^{k} \frac{1}{2^3} + \frac{1}{2^3} =
\displaystyle\sum_{i = 1}^{k} \frac{1}{4} = \frac{k}{4}
$$

## Устная и письменная часть

### № 4

